<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.0.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha256-yIDrPSXHZdOZhAqiBP7CKzIwMQmRCJ8UeB8Jo17YC4o=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"delick.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.19.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="介绍 RTTOV 流程和接口调用关系，以及部分数据结构">
<meta property="og:type" content="article">
<meta property="og:title" content="RTTOV interface &amp; data types">
<meta property="og:url" content="http://delick.github.io/2024/01/13/assim/rttov/interface/index.html">
<meta property="og:site_name" content="Delick&#39;s Blog">
<meta property="og:description" content="介绍 RTTOV 流程和接口调用关系，以及部分数据结构">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2024-01-13T05:16:46.000Z">
<meta property="article:modified_time" content="2024-01-14T07:15:57.627Z">
<meta property="article:author" content="Delick">
<meta property="article:tag" content="RTTOV">
<meta property="article:tag" content="data assimilation">
<meta property="article:tag" content="GSI">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://delick.github.io/2024/01/13/assim/rttov/interface/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://delick.github.io/2024/01/13/assim/rttov/interface/","path":"2024/01/13/assim/rttov/interface/","title":"RTTOV interface & data types"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>RTTOV interface & data types | Delick's Blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Delick's Blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">0 Error(s), 0 Warning(s).</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">6</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">3</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">5</span></a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#rttov-%E6%8E%A5%E5%8F%A3%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.</span> <span class="nav-text">RTTOV 接口数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="nav-number">1.1.</span> <span class="nav-text">接口调用流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gsi-%E4%B8%AD%E8%BE%90%E5%B0%84%E4%BC%A0%E8%BE%93%E6%A8%A1%E5%BC%8F%E6%8E%A5%E5%8F%A3"><span class="nav-number">1.2.</span> <span class="nav-text">GSI 中辐射传输模式接口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rttov-%E6%89%8B%E5%86%8C%E4%B8%AD%E7%9A%84%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="nav-number">1.3.</span> <span class="nav-text">RTTOV 手册中的调用流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E6%80%BB%E8%A1%A8"><span class="nav-number">1.4.</span> <span class="nav-text">数据结构总表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#rttov_direct-%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.4.1.</span> <span class="nav-text">RTTOV_direct 结构体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rttov_tl-%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.4.2.</span> <span class="nav-text">RTTOV_tl 结构体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rttov_ad-%E7%BB%93%E6%9E%84%E4%BD%93"><span class="nav-number">1.4.3.</span> <span class="nav-text">RTTOV_ad 结构体</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="nav-number">1.5.</span> <span class="nav-text">其他辅助函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E9%85%8D%E7%BD%AErttov_user_options_checkinput"><span class="nav-number">1.5.1.</span> <span class="nav-text">检查配置RTTOV_USER_OPTIONS_CHECKINPUT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E5%BB%93%E7%BA%BF-rttov_user_profile_checkinput"><span class="nav-number">1.5.2.</span> <span class="nav-text">检查廓线
RTTOV_USER_PROFILE_CHECKINPUT</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Delick"
      src="/uploads/avatar.jpg">
  <p class="site-author-name" itemprop="name">Delick</p>
  <div class="site-description" itemprop="description">My personal blog</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/delick" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;delick" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:delicktang@gmail.com" title="E-Mail → mailto:delicktang@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.researchgate.net/profile/Yibo-Tang-4" title="ResearchGate → https:&#x2F;&#x2F;www.researchgate.net&#x2F;profile&#x2F;Yibo-Tang-4" rel="noopener me" target="_blank"><i class="fa-brands fa-researchgate fa-fw"></i>ResearchGate</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://delick.github.io/2024/01/13/assim/rttov/interface/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="Delick">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Delick's Blog">
      <meta itemprop="description" content="My personal blog">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="RTTOV interface & data types | Delick's Blog">
      <meta itemprop="description" content="介绍 RTTOV 流程和接口调用关系，以及部分数据结构">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          RTTOV interface & data types
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2024-01-13 13:16:46" itemprop="dateCreated datePublished" datetime="2024-01-13T13:16:46+08:00">2024-01-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-01-14 15:15:57" itemprop="dateModified" datetime="2024-01-14T15:15:57+08:00">2024-01-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/data-assimilation/" itemprop="url" rel="index"><span itemprop="name">data assimilation</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/data-assimilation/satellite/" itemprop="url" rel="index"><span itemprop="name">satellite</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>3.5k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>13 分钟</span>
    </span>
</div>

            <div class="post-description">介绍 RTTOV 流程和接口调用关系，以及部分数据结构</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="rttov-接口数据类型">RTTOV 接口数据类型</h1>
<h2 id="接口调用流程">接口调用流程</h2>
<pre><code class="highlight mermaid">flowchart LR
linkStyle default interpolate basis

subgraph setup[&lt;b&gt;&lt;l&gt;同化外循环]
direction LR
	setuprhsall --&gt; setuprad 
	setuprad --&gt; crtm_intf
	setuprad --&gt; rttov_intf
  subgraph crtm_intf[&lt;b&gt;CRTM 接口]
    init_crtm
    call_crtm
    destroy_crtm
  end
  subgraph rttov_intf[&lt;b&gt;RTTOV 接口]
    init_rttov --&gt; call_rttov
    call_rttov --&gt; rttov_spec --&gt; destroy_rttov
    subgraph rttov_spec[&lt;b&gt;RTTOV流程]
    direction LR
      rt_opts[RTTO选项设置] --&gt; rt_coef
      rt_coef[读取系数文件] --&gt; rt_prof
      rt_prof[填充大气廓线] --&gt; rt_emis
      rt_emis[指定地表发射率] --&gt; rt_direct
      rt_direct[调用正向模式] --&gt; rt_k
      rt_k[调用K模式]
    end
    destroy_rttov
  end
end


classDef blue_item fill:#e7f0fd,stroke:#4285F4,stroke-width:2px,color:#2f2f2f;
classDef blue_group fill:#E3EDFD,stroke:#4285F4,stroke-width:2px,color:#4285F4;
classDef gray_group fill:#f2f2f2,stroke:#2f2f2f,stroke-width:2px,color:#2f2f2f;
classDef gray_item fill:#ffffff,stroke:#2f2f2f,stroke-width:2px,color:#2f2f2f;
classDef red_group fill:#f7d7d4,stroke:#DB4437,stroke-width:2px,color:#2f2f2f;
classDef red_item fill:#f7d7d4,stroke:#DB4437,stroke-width:2px,color:#DB4437;
classDef red_item_ingroup fill:#ffffff,stroke:#DB4437,stroke-width:2px,color:#DB4437;
classDef blue_item_ingroup fill:#ffffff,stroke:#4285F4,stroke-width:2px,color:#4285F4;
class rttov_intf blue_group
class crtm_intf,rtm_intf gray_group
class setup gray_item
class setuprhsall,setuprad gray_item
class rttov_spec red_group
class rt_opts,rt_coef,rt_prof,rt_emis,rt_direct,rt_k red_item_ingroup
class init_crtm,call_crtm,destroy_crtm gray_item
class init_rttov,call_rttov,destroy_rttov blue_item_ingroup</code></pre>
<span id="more"></span>
<h2 id="gsi-中辐射传输模式接口">GSI 中辐射传输模式接口</h2>
<pre><code class="highlight mermaid">flowchart LR
linkStyle default interpolate basis

subgraph setuprad[&lt;b&gt;同化外循环&lt;/b&gt;&lt;br&gt;&lt;tt&gt;setuprad.f90]
O(观测误差项&lt;br&gt;&lt;tt&gt;err2,raterr2)
K(RTTOV	辐射传输模式&lt;br&gt;&lt;tt&gt;rttov_direct&lt;/tt&gt;&lt;tt&gt;rttov_k&lt;/tt&gt;) --&gt; Tsim
K --&gt; Sens1
Sens1 --&gt; Sens2
Tsim(模拟亮温&lt;br&gt;&lt;tt&gt;Tsim) --&gt; TBC(O-B&lt;br&gt;&lt;tt&gt;tbc)
Sens1(RTM敏感性&lt;br&gt;&lt;tt&gt;temp, wmix, etc.)
Sens2(GSI敏感性&lt;br&gt;&lt;tt&gt;jacobian)

end

O --&gt; val
Sens2 --&gt; val
Sens2 --&gt; tval
TBC --&gt; val

subgraph intrad[&lt;b&gt;同化内循环&lt;/b&gt;&lt;br&gt;&lt;tt&gt;intrad]
direction LR
val(中间变量&lt;br&gt;&lt;tt&gt;val) --&gt; tval(观测点伴随返回值&lt;br&gt;&lt;tt&gt;tval) --&gt; rval(模式格网点返回值&lt;br&gt;&lt;tt&gt;rval)
end

classDef blue_item fill:#e7f0fd,stroke:#4285F4,stroke-width:2px,color:#2f2f2f;
classDef blue_group fill:#E3EDFD,stroke:#4285F4,stroke-width:2px,color:#4285F4;
classDef gray_group fill:#f2f2f2,stroke:#2f2f2f,stroke-width:2px,color:#2f2f2f;
classDef gray_item fill:#ffffff,stroke:#2f2f2f,stroke-width:2px,color:#2f2f2f;
classDef red_group fill:#f7d7d4,stroke:#DB4437,stroke-width:2px,color:#2f2f2f;
classDef red_item fill:#f7d7d4,stroke:#DB4437,stroke-width:2px,color:#DB4437;
classDef red_item_ingroup fill:#ffffff,stroke:#DB4437,stroke-width:2px,color:#DB4437;

class setuprad gray_group
class intrad gray_group
class K gray_group
class O,Sens2 gray_item
class val,rval gray_item
class Tsim,TBC,Sens1,tval blue_item</code></pre>
<h2 id="rttov-手册中的调用流程">RTTOV 手册中的调用流程</h2>
<ol type="1">
<li><p>设置 RTTOV 选项（<code>rttov_options</code>）</p>
<p>读系数前一定先选择模拟类型的最大范围，不然可能会分配内存出错。</p>
<p>还可以记录错误日志，使用<code>rttov_errorhandling</code>函数，可以在任何地方调用。</p></li>
<li><p>初始化系数结构（<code>rttov_coefs</code>）</p>
<p>用于光学厚度系数文件（<code>rtcoef)</code>）、可见光/红外的云和气溶胶系数（<code>sccldcoef</code>,
<code>scaercoef</code>）以及 PC-RTTOV
系数文件（<code>pccoef</code>）</p>
<ol type="1">
<li>定义 <code>rttov_coefs</code> 类型</li>
<li>读取各仪器系数文件：调用 <code>rttov_read_coefs</code> 函数</li>
<li>检查输入选项和系数文件问题：<code>rttov_user_options_checkinput</code></li>
<li>（可选）系数文件格式转换：<code>bin/rttov_conv_coef.exe</code>，参考
<em>Annex A</em>查看控制台命令说明</li>
<li>（可选）系数文件版本转换：<code>rttov11_conv_coef_11to12.exe</code>，参考
<em>Annex A</em></li>
<li>（可选）如果开启可变气体，需要提供对应廓线</li>
</ol></li>
<li><p>设置<strong>输入廓线</strong></p>
<p>可参考 <code>src/test/example_fwd.F90</code> 设置输入廓线。</p>
<ol type="1">
<li>分配内存：廓线矩阵维度需要与每次调用 RTTOV 时的廓线数一致。可调用
<code>rttov_alloc_prof</code>分配廓线中的多个矩阵。</li>
<li>初始化廓线变量至 0</li>
<li>填充廓线数据，参考 <em>Table 12</em> 查看是否必填，以及是否支持 TL
模式。</li>
<li>压力层和插值：如果输入廓线在任意压力层（与 RTTOV 的 54/101
层不一致），则需要打开插值开关（<code>opts%interpolation%addinterp</code>）。输入廓线可以不在
RTTOV 压力层上，但每次调用 RTTOV 函数时，输入廓线的压力层要一致。</li>
<li>设置地表压力：位于<code>profile%s2m%p</code></li>
<li>稀有气体：查看 <em>Table 4 in Section 3</em>寻找可用气体种类
<ol type="1">
<li>打开稀有气体对应开关</li>
<li>提供稀有气体廓线</li>
</ol></li>
<li>输入廓线数据的限制：硬性限制参考
<code>rttov_const.F90</code>，超出限制会终止模拟，报错退出。
<ol type="1">
<li>（可选）检查廓线输入：<code>rttov_user_profile_checkinput</code>，可以在调用
RTTOV 前检查硬性限制和回归限制。</li>
<li>（可选）关闭 <code>opts%config%verbose</code>
禁用超过回归限制的廓线警告</li>
<li>（可选）关闭 <code>opts%config%apply_reg_limits</code>
将超出回归范围的廓线裁剪到合理范围内，也可以避免回归限制警告</li>
</ol></li>
</ol></li>
<li><p>指定<strong>模拟的通道编号</strong></p>
<ol type="1">
<li><p>分配内存：<code>chanprof</code>
用于存储通道下标和廓线下标，维度为单次调用 RTTOV
所用到的所有通道数总和。可参考 <em>Table 13</em>
设置。第一条廓线的所有通道、第二条廓线的所有通道、……、最后一条廓线的所有通道</p></li>
<li><p>廓线下标（<code>chanprof(j)%prof</code>）</p></li>
<li><p>通道下标（<code>chanprof(j)%chan</code>）</p>
<p>其中，j 从 1 到每次调用 RTTOV 需要模拟的辐射数</p></li>
</ol></li>
<li><p>指定<strong>表面发射率</strong></p>
<p>表面发射率与地表类型相关（陆地/海洋/海冰等），可通过
<code>profiles(:)%skin%surfacetype</code> 设置。</p>
<ol type="1">
<li>分配内存： <code>calcemis(:)</code> 和
<code>emissivity(:)</code>，维度与 <code>chanprof(:)</code> 一致。</li>
<li>填充变量：
<ol type="1">
<li>使用内部数据集：<code>calcemis(j)</code> 设置为 True
即可从内部计算</li>
<li>使用自己数据：<code>calcemis(j)</code> 设置为 False，并填充
<code>emissivity(j)%emis_in</code> 矩阵</li>
</ol></li>
<li>对于<strong>微波发射率</strong>：FASTEM, TESSEM2 两个模式可使用
<ul>
<li>FASTEM 同时提供了海表、地表、雪冰表面的发射率。有 6 个版本，可通过
<code>opts%rt_mw%fastem_version</code> 指定版本，默认为 6（适用 200GHz
以下通道）。200GHz 以上推荐使用 TESSEM2。需要输入：10
米风速、表面温度、盐度、天顶角、方位角。</li>
<li>TESSEM2 仅适用于海表发射率。200GHz 以上推荐使用
TESSEM2。廓线需要：10
米风速、表面温度、盐度、天顶角。<code>opts%rt_mw%fastem_version</code>
设置为 0 即可使用。</li>
</ul></li>
<li><strong>对于红外发射率</strong>：ISEM and IREMIS 模型。</li>
<li><strong>切线性发射率</strong>：使用 FASTEM, TESSEM2 和 IREMIS
模型时，切线性模型会计算发射率扰动（emissivity perturbation），只要
<code>emissivity_tl(:)%emis_in</code> 设置为 0。</li>
<li><strong>地表发射率</strong>：红外和微波发射率有数据集，可调用外部数据集</li>
<li>UWIR 和 CAMEL IR 发射率数据集：用于 PC-RTTOV</li>
<li>TELSEM2
微波数据集和插值：可用于所有微波仪器。支持地表类型：海面/海冰/陆地。
<ol type="1">
<li>输入：必选 经纬度、天顶角（zenagle）</li>
<li>输出：发射率（负为无数据）、（可选）各通道发射率标准差、（可选）所有指定通道的发射率协方差矩阵（每条廓线一个矩阵）</li>
</ol></li>
<li>CNRM 微波数据集：只支持 AMSU-A, AMSH-B/MHS, SSMI/S 和
ATMS。支持地表类型：海面/海冰。
<ol type="1">
<li>输入：必选 经纬度、天顶角（zenagle）、地表类型</li>
<li>输出：发射率（负为无数据）</li>
</ol></li>
</ol></li>
<li><p>指定地表反射率，用于太阳通道模拟：输入类似发射率，需要地表类型（<code>profiles(:)%skin%surfacetype</code>）和二向反射（BRDF）输入。可读取
BRDF 数据集获取。</p>
<ol type="1">
<li>输入：
<ol type="1">
<li>必选：经纬度、地表类型、天顶角、太阳天顶角、方位角、太阳方位角</li>
<li>可选：水体类型（仅用于海表）</li>
</ol></li>
<li>输出：
<ol type="1">
<li>发射率（负为无数据）</li>
<li>（可选）双半球（黑天）反照率（bi-hemispherical (black-sky)
albedo）、质控标记</li>
</ol></li>
<li>接口：<code>rttov_setup_brdf_atlas</code>分配内存矩阵大小，读取指定月份数据；<code>rttov_get_brdf</code>
返回给定经纬度和通道的 BRDF 值；<code>rttov_deallocate_brdf_atlas</code>
清理数据集内存。</li>
</ol></li>
<li><p>分配轨迹结构体内存</p>
<p>如果多次调用 RTTOV，可以在调用 RTTOV 前先分配内部数据结构，再在所有
RTTOV 调用完后清理这些结构体内存。使用 <code>rttov_alloc_traj</code>
子进程或 <em>Annex D</em> 中的 <code>rttov_alloc_direct/tl/ad/k</code>
子进程。第二次调用 <code>rttov_alloc_traj</code> 可以清理内存。</p></li>
<li><p>RTTOV 输出矩阵</p>
<p><code>rttov_direct</code> 输出数据：</p>
<ol type="1">
<li><code>errorstatus</code> 整形，返回错误信息。非 0 表示致命错误</li>
<li><code>transmission</code>, <code>radiance</code> 分别为
<code>rttov_transmission</code> 和 <code>rttov_radiance</code>
的派生结构体，需要提前定义。可选定义
<code>radiance2</code>。<code>radiance</code>结构体包括：
<ul>
<li>必选：辐射率（radiance）、亮温以及反射率输出（<em>8.2节有反射率量的定义</em>）。</li>
<li>可选：辐射率2（radiance2）包括辅助辐射输出，正向模型计算得到，用于非散射、非太阳、非
PC-RTTOV 模拟。</li>
</ul></li>
</ol></li>
<li><p>切线性（TL）、伴随（AD）和雅可比（K）模式</p>
<p>共同点：</p>
<ul>
<li>与正向模型相同的输入：大气廓线、地表参数</li>
<li>都输出：正向模型辐射、亮温和反射率</li>
<li>都支持并行：使用 OpenMP，与正向模式一样</li>
<li>不是所有廓线变量都支持：<em>Table 12</em> 列出了能 TL
扰动的变量，并因此不为 0 的 Jacobian 和 AD 输出。</li>
</ul>
<ol type="1">
<li><p>切线性模式：TL
模式计算了正向模型在给定廓线处的的切线，输出此处给定廓线扰动的卫星观测辐射变化率。</p>
<ul>
<li>输入<code>profiles_tl(:)</code>
廓线结构体，包括对廓线的一系列扰动。数据维度与输入
<code>profiles(:)</code> 矩阵一致。</li>
<li>输出：辐射、亮温和反射率扰动</li>
</ul></li>
<li><p>伴随模式</p>
<ul>
<li>输入：标量函数（如代价函数）的梯度，相对于卫星观测到的辐射（或亮温）</li>
<li>输出：标量函数梯度，相对于廓线变量（<code>profiles_ad(:)</code>）。<code>profiles_ad(:)</code>
与 <code>profiles(:)</code> 矩阵应当维度一致。</li>
</ul></li>
<li><p>K 模式</p>
<ul>
<li>输入：<code>radiance_k</code> 中的辐射扰动（或亮温扰动）</li>
<li>输出：正向模型辐射的梯度，相对于给定的输入廓线
<code>profiles_k(:)</code> 中的每条廓线变量</li>
<li><code>profiles_k(:)</code> 维度与 <code>chanprof(:)</code>
一致。</li>
</ul>
<p>调整单位：<code>opts%rt_all%switchrad</code> 设置为 false，输入扰动为
<code>radiance_ad/k%total(:)</code>（辐射单位）；否则，输入扰动需为
<code>radiance_ad/k%bt(:)</code> （K）</p>
<p>AD/K 输入输出矩阵在调用 AD / K 模型前需要初始化为
0。包括以下结构体和矩阵：</p>
<ol type="1">
<li><code>profiles_ad/k</code> （使用
<code>rttov_init_prof</code>）</li>
<li><code>transmission_ad/k</code> （使用
<code>rttov_init_transmission</code>）</li>
<li><code>radiance_ad/k</code>（指定 <code>total(:)</code> 和
<code>bt(:);</code><strong>扰动前</strong>，使用
<code>rttov_init_rad</code>）</li>
<li><code>emissivity</code> （设置 <code>emis_in(:)</code> 和
<code>emis_out(:)</code> 均为 0 ）</li>
<li><code>reflectance</code> （设置 <code>refl_in(:)</code> 和
<code>refl_out(:)</code> 均为 0）</li>
</ol>
<p>输出时，<code>emissivity_ad/k(:)%emis_in</code> 和
<code>reflectance_ad/k(:)%refl_in</code> 矩阵分别包括了地表发射率和 BRDF
的 AD / Jacobian 矩阵。</p></li>
</ol></li>
<li><p>多线程：</p>
<p>多线程接口与 <code>rttov_direct</code>, <code>rttov_tl</code>,
<code>rttov_ad</code>和 <code>rttov_k</code> 一一对应，分别叫
<code>rttov_parallel_direct</code>、<code>rttov_parallel_tl</code>等等。选项中多了一个
<code>nthreads</code> 指定并行进程数。</p></li>
</ol>
<h2 id="数据结构总表">数据结构总表</h2>
<table>
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Type name</strong></th>
<th><strong>Purpose</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d3/d9b/structrttov__types_1_1rttov__options.html"><strong>rttov_options</strong></a></td>
<td>RTTOV options structure to configure simulations.</td>
</tr>
<tr class="even">
<td>rttov_options_scatt</td>
<td>Limited set of options for configuring RTTOV-SCATT.</td>
</tr>
<tr class="odd">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/df/d77/structrttov__types_1_1rttov__coefs.html"><strong>rttov_coefs</strong></a></td>
<td>Coefficients structure for optical depth, cloud, aerosol and PC
coefficients.</td>
</tr>
<tr class="even">
<td>rttov_scatt_coef</td>
<td>Coefficients structure for RTTOV-SCATT Mie table coefficients.</td>
</tr>
<tr class="odd">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d0/da3/structrttov__types_1_1rttov__chanprof.html"><strong>rttov_chanprof</strong></a></td>
<td>Define channel/profile indexes to simulate.</td>
</tr>
<tr class="even">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d8/d60/structrttov__types_1_1rttov__profile.html"><strong>rttov_profile</strong></a></td>
<td>Input profile.</td>
</tr>
<tr class="odd">
<td>rttov_profile_cloud</td>
<td>Input cloudy profile for RTTOV-SCATT.</td>
</tr>
<tr class="even">
<td>rttov_opt_param</td>
<td>Explicit aerosol/cloud optical parameter profiles.</td>
</tr>
<tr class="odd">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d0/dae/structrttov__types_1_1rttov__emissivity.html"><strong>rttov_emissivity</strong></a></td>
<td>Input/output surface emissivity values.</td>
</tr>
<tr class="even">
<td>rttov_reflectance</td>
<td>Input/output surface BRDF values and cloud-top BRDF for simple cloud
scheme.</td>
</tr>
<tr class="odd">
<td>rttov_traj</td>
<td>Holds various internal variables for repeated RTTOV calls
(optional).</td>
</tr>
<tr class="even">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d7/d06/structrttov__types_1_1rttov__radiance.html"><strong>rttov_radiance</strong></a></td>
<td>Calculated radiances.</td>
</tr>
<tr class="odd">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/dc/dbf/structrttov__types_1_1rttov__radiance2.html"><strong>rttov_radiance2</strong></a></td>
<td>Secondary direct model radiances (optional).</td>
</tr>
<tr class="even">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/db/d76/structrttov__types_1_1rttov__transmission.html"><strong>rttov_transmission</strong></a></td>
<td>Calculated transmittances.</td>
</tr>
<tr class="odd">
<td>rttov_pccomp</td>
<td>Calculated PC scores and reconstructed radiances.</td>
</tr>
<tr class="even">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d5/d4b/classmod__rttov__emis__atlas.html"><strong>rttov_emis_atlas_data</strong></a></td>
<td>Holds data for an emissivity atlas (from
<em>mod_rttov_emis_atlas.F90</em>)</td>
</tr>
<tr class="odd">
<td><a href="D:/assimilation/rttov121/docs/doxygen_doc_user/html/d3/d09/classmod__rttov__brdf__atlas.html"><strong>rttov_brdf_atlas_data</strong></a></td>
<td>Holds data for a BRDF atlas (from
<em>mod_rttov_brdf_atlas.F90</em>)</td>
</tr>
</tbody>
</table>
<p>加粗字体为需要使用的数据结构体。</p>
<h3 id="rttov_direct-结构体"><code>RTTOV_direct</code> 结构体</h3>
<table>
<colgroup>
<col style="width: 32%">
<col style="width: 32%">
<col style="width: 35%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>In/Out</th>
<th>Variable</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Integer</td>
<td>Intent(out)</td>
<td>errorstatus</td>
</tr>
<tr class="even">
<td>Type(rttov_chanprof)</td>
<td>Intent(in)</td>
<td>chanprof(nchanprof)</td>
</tr>
<tr class="odd">
<td>Type(rttov_options)</td>
<td>Intent(in)</td>
<td>opts</td>
</tr>
<tr class="even">
<td>Type(rttov_profile)</td>
<td>Intent(in)</td>
<td>profiles(nprof)</td>
</tr>
<tr class="odd">
<td>Type(rttov_coefs)</td>
<td>Intent(in)</td>
<td>coefs</td>
</tr>
<tr class="even">
<td>Type(rttov_transmission)</td>
<td>Intent(inout)</td>
<td>transmission</td>
</tr>
<tr class="odd">
<td>Type(rttov_radiance)</td>
<td>Intent(inout)</td>
<td>radiance</td>
</tr>
<tr class="even">
<td>Type(rttov_radiance2)</td>
<td>Intent(inout), optional</td>
<td>radiance2</td>
</tr>
<tr class="odd">
<td>Logical</td>
<td>Intent(in), optional</td>
<td>calcemis(nchanprof)</td>
</tr>
<tr class="even">
<td>Type(rttov_emissivity)</td>
<td>Intent(inout), optional</td>
<td>emissivity(nchanprof)</td>
</tr>
<tr class="odd">
<td>Logical</td>
<td>Intent(in), optional</td>
<td>calcrefl(nchanprof)</td>
</tr>
<tr class="even">
<td>Type(rttov_reflectance)</td>
<td>Intent(in), optional</td>
<td>reflectance(nchanprof)</td>
</tr>
<tr class="odd">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>aer_opt_param</td>
</tr>
<tr class="even">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>cld_opt_param</td>
</tr>
<tr class="odd">
<td>Type(rttov_traj)</td>
<td>Intent(inout), optional</td>
<td>traj</td>
</tr>
<tr class="even">
<td>Type(rttov_pccomp)</td>
<td>Intent(inout), optional</td>
<td>pccomp</td>
</tr>
<tr class="odd">
<td>Integer</td>
<td>Intent(in), optional</td>
<td>channels_rec(nchannelsrec)</td>
</tr>
</tbody>
</table>
<h3 id="rttov_tl-结构体"><code>RTTOV_tl</code> 结构体</h3>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>In/Out</th>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Integer</td>
<td>Intent(out)</td>
<td>errorstatus</td>
<td>Return code.</td>
</tr>
<tr class="even">
<td>Type(rttov_chanprof)</td>
<td>Intent(in)</td>
<td>chanprof(nchanprof)</td>
<td>Chanprof structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_options)</td>
<td>Intent(in)</td>
<td>opts</td>
<td>RTTOV options structure</td>
</tr>
<tr class="even">
<td>Type(rttov_profile)</td>
<td>Intent(in)</td>
<td>profiles(nprof)</td>
<td>Profiles structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_profile)</td>
<td>Intent(inout)</td>
<td>profiles_tl(nprof)</td>
<td>Input profile variable increments.</td>
</tr>
<tr class="even">
<td>Type(rttov_coefs)</td>
<td>Intent(in)</td>
<td>coefs</td>
<td>RTTOV coefficient structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_transmission)</td>
<td>Intent(inout)</td>
<td>transmission</td>
<td>Output transmittances (0-1).</td>
</tr>
<tr class="even">
<td>Type(rttov_transmission)</td>
<td>Intent(inout)</td>
<td>transmission_tl</td>
<td>TL of transmittances.</td>
</tr>
<tr class="odd">
<td>Type(rttov_radiance)</td>
<td>Intent(inout)</td>
<td>radiance</td>
<td>Direct model output radiances (<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.005ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 7958.2 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1926,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(2426,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="msup" transform="translate(2859,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(911,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4723.7,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(5223.7,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(5692.7,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6143.7,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="msup" transform="translate(6643.7,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(911,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container></span>, degK,
BRF/unitless).</td>
</tr>
<tr class="even">
<td>Type(rttov_radiance)</td>
<td>Intent(inout)</td>
<td>radiance_tl</td>
<td>TL of radiances.</td>
</tr>
<tr class="odd">
<td>Logical</td>
<td>Intent(in), optional</td>
<td>calcemis(nchanprof)</td>
<td>.true. if RTTOV should calculate/select surface emissivity
internally or .false. if user is supplying an emissivity value (e.g.
from an atlas).</td>
</tr>
<tr class="even">
<td>Type(rttov_emissivity)</td>
<td>Intent(inout), optional</td>
<td>emissivity(nchanprof)</td>
<td>Input/output emissivities.</td>
</tr>
<tr class="odd">
<td>Type(rttov_emissivity)</td>
<td>Intent(inout), optional</td>
<td>emissivity_tl(nchanprof)</td>
<td>Input/output surface emissivity TL.</td>
</tr>
<tr class="even">
<td>Logical</td>
<td>Intent(in), optional</td>
<td>calcrefl(nchanprof)</td>
<td>.true. if RTTOV should calculate/select surface BRDF internally or
.false. if user is supplying a BRDF value (e.g. from the atlas).</td>
</tr>
<tr class="odd">
<td>Type(rttov_reflectance)</td>
<td>Intent(inout), optional</td>
<td>reflectance(nchanprof)</td>
<td>Input/output BRDFs.</td>
</tr>
<tr class="even">
<td>Type(rttov_reflectance)</td>
<td>Intent(inout), optional</td>
<td>reflectance_tl(nchanprof)</td>
<td>Input/output surface BRDF TL.</td>
</tr>
<tr class="odd">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>aer_opt_param</td>
<td>Aerosol optical parameter input profiles if
<strong><code>opts%rt_ir%addaerosl</code></strong> and
<strong><code>opts%rt_ir%user_aer_opt_param</code></strong> are
true.</td>
</tr>
<tr class="even">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>cld_opt_param</td>
<td>Cloud optical parameter input profiles if
<strong><code>opts%rt_ir%addclouds</code></strong> and
<strong><code>opts%rt_ir%user_cld_opt_param</code></strong> are
true.</td>
</tr>
<tr class="odd">
<td>Type(rttov_traj)</td>
<td>Intent(inout), optional</td>
<td>traj</td>
<td>Trajectory structure to hold temporary data.</td>
</tr>
<tr class="even">
<td>Type(rttov_traj)</td>
<td>Intent(inout), optional</td>
<td>traj_tl</td>
<td>Trajectory structure to hold temporary data.</td>
</tr>
<tr class="odd">
<td>Type(rttov_pccomp)</td>
<td>Intent(inout), optional</td>
<td>pccomp</td>
<td>Structure to hold output PC scores and reconstructed radiances.</td>
</tr>
<tr class="even">
<td>Type(rttov_pccomp)</td>
<td>Intent(inout), optional</td>
<td>pccomp_tl</td>
<td>TL of principal components.</td>
</tr>
<tr class="odd">
<td>Integer</td>
<td>Intent(in), optional</td>
<td>channels_rec(nchannelsrec)</td>
<td>Channels for which to compute reconstructed radiances if
<strong><code>opts%rt_ir%pc%addradrec</code></strong> is .true.</td>
</tr>
</tbody>
</table>
<h3 id="rttov_ad-结构体"><code>RTTOV_ad</code> 结构体</h3>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 19%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>In/Out</th>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Integer</td>
<td>Intent(out)</td>
<td>errorstatus</td>
<td>Return code.</td>
</tr>
<tr class="even">
<td>Type(rttov_chanprof)</td>
<td>Intent(in)</td>
<td>chanprof(nchanprof)</td>
<td>Chanprof structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_options)</td>
<td>Intent(in)</td>
<td>opts</td>
<td>RTTOV options structure</td>
</tr>
<tr class="even">
<td>Type(rttov_profile)</td>
<td>Intent(in)</td>
<td>profiles(nprof)</td>
<td>Profiles structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_profile)</td>
<td>Intent(inout)</td>
<td>profiles_ad(nprof)</td>
<td>AD on profile variables.</td>
</tr>
<tr class="even">
<td>Type(rttov_coefs)</td>
<td>Intent(in)</td>
<td>coefs</td>
<td>RTTOV coefficient structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_transmission)</td>
<td>Intent(inout)</td>
<td>transmission</td>
<td>Output transmittances (0-1).</td>
</tr>
<tr class="even">
<td>Type(rttov_transmission)</td>
<td>Intent(inout)</td>
<td>transmission_ad</td>
<td>AD of transmittances.</td>
</tr>
<tr class="odd">
<td>Type(rttov_radiance)</td>
<td>Intent(inout)</td>
<td>radiance</td>
<td>Direct model output radiances (<span class="math inline"><mjx-container class="MathJax" jax="SVG"><svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.005ex" height="2.452ex" role="img" focusable="false" viewBox="0 -833.9 7958.2 1083.9"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mi" transform="translate(878,0)"><path data-c="1D44A" d="M436 683Q450 683 486 682T553 680Q604 680 638 681T677 682Q695 682 695 674Q695 670 692 659Q687 641 683 639T661 637Q636 636 621 632T600 624T597 615Q597 603 613 377T629 138L631 141Q633 144 637 151T649 170T666 200T690 241T720 295T759 362Q863 546 877 572T892 604Q892 619 873 628T831 637Q817 637 817 647Q817 650 819 660Q823 676 825 679T839 682Q842 682 856 682T895 682T949 681Q1015 681 1034 683Q1048 683 1048 672Q1048 666 1045 655T1038 640T1028 637Q1006 637 988 631T958 617T939 600T927 584L923 578L754 282Q586 -14 585 -15Q579 -22 561 -22Q546 -22 542 -17Q539 -14 523 229T506 480L494 462Q472 425 366 239Q222 -13 220 -15T215 -19Q210 -22 197 -22Q178 -22 176 -15Q176 -12 154 304T131 622Q129 631 121 633T82 637H58Q51 644 51 648Q52 671 64 683H76Q118 680 176 680Q301 680 313 683H323Q329 677 329 674T327 656Q322 641 318 637H297Q236 634 232 620Q262 160 266 136L501 550L499 587Q496 629 489 632Q483 636 447 637Q428 637 422 639T416 648Q416 650 418 660Q419 664 420 669T421 676T424 680T428 682T436 683Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(1926,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(2426,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path></g><g data-mml-node="msup" transform="translate(2859,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" transform="translate(911,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mo"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path></g><g data-mml-node="mn" transform="translate(778,0)"><path data-c="31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></g></g></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(4723.7,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="mi" transform="translate(5223.7,0)"><path data-c="1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path></g><g data-mml-node="mi" transform="translate(5692.7,0)"><path data-c="1D45F" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(6143.7,0)"><g data-mml-node="mo"><path data-c="2F" d="M423 750Q432 750 438 744T444 730Q444 725 271 248T92 -240Q85 -250 75 -250Q68 -250 62 -245T56 -231Q56 -221 230 257T407 740Q411 750 423 750Z"></path></g></g><g data-mml-node="msup" transform="translate(6643.7,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></g><g data-mml-node="mn" transform="translate(911,363) scale(0.707)"><path data-c="32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path></g></g></g></g></svg></mjx-container></span>, degK,
BRF/unitless).</td>
</tr>
<tr class="even">
<td>Type(rttov_radiance)</td>
<td>Intent(inout)</td>
<td>radiance_ad</td>
<td>Input radiance perturbations (see text).</td>
</tr>
<tr class="odd">
<td>Logical</td>
<td>Intent(in), optional</td>
<td>calcemis(nchanprof)</td>
<td>.true. if RTTOV should calculate/select surface emissivity
internally or .false. if user is supplying an emissivity value (e.g.
from an atlas).</td>
</tr>
<tr class="even">
<td>Type(rttov_emissivity)</td>
<td>Intent(inout), optional</td>
<td>emissivity(nchanprof)</td>
<td>Input/output emissivities.</td>
</tr>
<tr class="odd">
<td>Type(rttov_emissivity)</td>
<td>Intent(inout), optional</td>
<td>emissivity_ad(nchanprof)</td>
<td>AD on surface emissivity.</td>
</tr>
<tr class="even">
<td>Logical</td>
<td>Intent(in), optional</td>
<td>calcrefl(nchanprof)</td>
<td>.true. if RTTOV should calculate/select surface BRDF internally or
.false. if user is supplying a BRDF value (e.g. from the atlas).</td>
</tr>
<tr class="odd">
<td>Type(rttov_reflectance)</td>
<td>Intent(inout), optional</td>
<td>reflectance(nchanprof)</td>
<td>Input/output BRDFs.</td>
</tr>
<tr class="even">
<td>Type(rttov_reflectance)</td>
<td>Intent(inout), optional</td>
<td>reflectance_ad(nchanprof)</td>
<td>AD on surface BRDF.</td>
</tr>
<tr class="odd">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>aer_opt_param</td>
<td>Aerosol optical parameter input profiles if
<strong><code>opts%rt_ir%addaerosl</code></strong> and
<strong><code>opts%rt_ir%user_aer_opt_param</code></strong> are
true.</td>
</tr>
<tr class="even">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>cld_opt_param</td>
<td>Cloud optical parameter input profiles if
<strong><code>opts%rt_ir%addclouds</code></strong> and
<strong><code>opts%rt_ir%user_cld_opt_param</code></strong> are
true.</td>
</tr>
<tr class="odd">
<td>Type(rttov_traj)</td>
<td>Intent(inout), optional</td>
<td>traj</td>
<td>Trajectory structure to hold temporary data.</td>
</tr>
<tr class="even">
<td>Type(rttov_traj)</td>
<td>Intent(inout), optional</td>
<td>traj_ad</td>
<td>Trajectory structure to hold temporary data.</td>
</tr>
<tr class="odd">
<td>Type(rttov_pccomp)</td>
<td>Intent(inout), optional</td>
<td>pccomp</td>
<td>Structure to hold output PC scores and reconstructed radiances.</td>
</tr>
<tr class="even">
<td>Type(rttov_pccomp)</td>
<td>Intent(inout), optional</td>
<td>pccomp_ad</td>
<td>Input PC or reconstructed radiance perturbations (see text).</td>
</tr>
<tr class="odd">
<td>Integer</td>
<td>Intent(in), optional</td>
<td>channels_rec(nchannelsrec)</td>
<td>Channels for which to compute reconstructed radiances if
<strong><code>opts%rt_ir%pc%addradrec</code></strong> is .true.</td>
</tr>
</tbody>
</table>
<h2 id="其他辅助函数">其他辅助函数</h2>
<h3 id="检查配置rttov_user_options_checkinput">检查配置<code>RTTOV_USER_OPTIONS_CHECKINPUT</code></h3>
<p>P120</p>
<table>
<colgroup>
<col style="width: 28%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 43%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>In/Out</th>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Integer</td>
<td>Intent(out)</td>
<td>err</td>
<td>Return code.</td>
</tr>
<tr class="even">
<td>Type(rttov_options)</td>
<td>Intent(in)</td>
<td>opts</td>
<td>Options structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_coefs)</td>
<td>Intent(in)</td>
<td>coefs</td>
<td>RTTOV coefficients structure.</td>
</tr>
</tbody>
</table>
<h3 id="检查廓线-rttov_user_profile_checkinput">检查廓线
<code>RTTOV_USER_PROFILE_CHECKINPUT</code></h3>
<p>P120</p>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 49%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>In/Out</th>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Integer</td>
<td>Intent(out)</td>
<td>err</td>
<td>Return code.</td>
</tr>
<tr class="even">
<td>Type(rttov_options)</td>
<td>Intent(in)</td>
<td>opts</td>
<td>Options structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_coefs)</td>
<td>Intent(in)</td>
<td>coefs</td>
<td>RTTOV coefficients structure.</td>
</tr>
<tr class="even">
<td>Type(rttov_profile)</td>
<td>Intent(in)</td>
<td>prof</td>
<td>Profile structure.</td>
</tr>
<tr class="odd">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>aer_opt_param</td>
<td>Aerosol optical parameter profiles.</td>
</tr>
<tr class="even">
<td>Type(rttov_opt_param)</td>
<td>Intent(in), optional</td>
<td>cld_opt_param</td>
<td>Cloud optical parameter profiles.</td>
</tr>
<tr class="odd">
<td>Logical</td>
<td>Intent(out), optional</td>
<td>reg_limits_exceeded</td>
<td>Set to true if any profile variable exceeds the RTTOV regression
limits</td>
</tr>
</tbody>
</table>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Delick
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://delick.github.io/2024/01/13/assim/rttov/interface/" title="RTTOV interface &amp; data types">http://delick.github.io/2024/01/13/assim/rttov/interface/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/RTTOV/" rel="tag"># RTTOV</a>
              <a href="/tags/data-assimilation/" rel="tag"># data assimilation</a>
              <a href="/tags/GSI/" rel="tag"># GSI</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/01/13/hello-world/" rel="prev" title="Hello World">
                  <i class="fa fa-angle-left"></i> Hello World
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2024/01/13/assim/wrfda/interface/" rel="next" title="WRFDA同化框架代码注释">
                  WRFDA同化框架代码注释 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Delick</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">8k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">29 分钟</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  

  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":{"light":"default","dark":"dark"},"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js","integrity":"sha256-mm3Re3y7xlvh+yCD+l/Zs1d+PU0AEad93MkWvljfm/s="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
